<html>
<head>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: Inter, sans-serif;
    }

    body {
      background: #ffffff;
      min-height: 100vh;
      position: relative;
    }

    .container {
      padding: 24px;
      padding-bottom: 80px;
    }

    .content {
      display: flex;
      flex-direction: column;
      gap: 24px;
    }

    .title {
      font-size: 24px;
      font-weight: 600;
      color: #000000;
      margin-bottom: 8px;
    }

    .form-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    label {
      font-size: 14px;
      font-weight: 500;
      color: #333;
    }

    input[type="text"], input[type="date"] {
      width: 100%;
      padding: 12px;
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      font-size: 14px;
      transition: border-color 0.2s;
    }

    input[type="text"]:focus, input[type="date"]:focus {
      outline: none;
      border-color: #18A0FB;
    }

    .gradient-presets {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .gradient-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 8px;
      margin-bottom: 16px;
    }

    .gradient-option {
      height: 32px;
      border-radius: 6px;
      cursor: pointer;
      transition: transform 0.2s, border-color 0.2s;
      border: 2px solid transparent;
      background-size: 100% 100%;
    }

    .gradient-option:hover {
      transform: scale(1.02);
    }

    .gradient-option.selected {
      border: 3px solid #18A0FB;
      box-shadow: 0 0 0 2px rgba(24, 160, 251, 0.3);
    }

    .custom-colors {
      display: flex;
      gap: 12px;
      justify-content: space-between;
      margin-bottom: 16px;
    }

    .color-input {
      background: white;
      padding: 8px;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }

    .color-input input[type="color"] {
      -webkit-appearance: none;
      width: 36px;
      height: 36px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      padding: 0;
    }

    .color-preview {
      width: 24px;
      height: 24px;
      border-radius: 4px;
      margin-right: 8px;
    }

    .gradient-preview {
      height: 80px;
      border-radius: 12px;
      margin: 16px 0;
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    .angle-control {
      background: #F5F5F5;
      border-radius: 8px;
      padding: 12px;
      margin-bottom: 16px;
    }

    .angle-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }

    .angle-value {
      font-size: 12px;
      font-weight: 500;
      color: #666;
    }

    input[type="range"] {
      width: 100%;
      height: 4px;
      background: #E0E0E0;
      border-radius: 2px;
      -webkit-appearance: none;
    }

    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 16px;
      height: 16px;
      background: #18A0FB;
      border-radius: 50%;
      cursor: pointer;
      transition: transform 0.2s;
    }

    input[type="range"]::-webkit-slider-thumb:hover {
      transform: scale(1.1);
    }

    .buttons {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      padding: 16px 24px;
      display: flex;
      gap: 12px;
      background: #ffffff;
      border-top: 1px solid #e0e0e0;
    }

    button {
      flex: 1;
      padding: 12px;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
      border: none;
    }

    .create-btn {
      background: #18A0FB;
      color: white;
    }

    .create-btn:hover {
      background: #0D8DE3;
    }

    .cancel-btn {
      background: #F5F5F5;
      color: #333;
    }

    .cancel-btn:hover {
      background: #E8E8E8;
    }

    .icon-button {
      background: none;
      border: none;
      cursor: pointer;
      padding: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: transform 0.2s;
    }

    .icon-button:hover {
      transform: scale(1.1);
    }

    .icon-button svg {
      width: 20px;
      height: 20px;
    }

    .icon-button path {
      fill: #333;
    }

    .random-button {
      width: 36px;
      height: 36px;
      border-radius: 8px;
      background: #F5F5F5;
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.2s;
      padding: 8px;
    }

    .random-button:hover {
      background: #E8E8E8;
    }

    .random-button svg {
      width: 20px;
      height: 20px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="content">
      <h1 class="title">Gradient Cover Creator</h1>

      <div class="form-group">
        <label for="title">Title</label>
        <input type="text" id="title" placeholder="Enter title">
      </div>

      <div class="form-group">
        <label for="subtitle">Subtitle</label>
        <input type="text" id="subtitle" placeholder="Please enter your summary">
      </div>

      <div class="form-group">
        <label for="date">Date</label>
        <input type="date" id="date">
      </div>

      <div class="form-group">
        <label for="author">Author</label>
        <input type="text" id="author" value="Design Team">
      </div>

      <div class="gradient-presets">
        <label>Select Gradient</label>
        <div class="gradient-grid">
        </div>
        <div class="custom-colors">
          <div class="color-input">
            <input type="color" id="color1" value="#4ED4DC">
          </div>
          <div class="color-input">
            <input type="color" id="color2" value="#BB4ACF">
          </div>
          <div class="color-input">
            <input type="color" id="color3" value="#C348DB">
          </div>
          <div class="color-input">
            <input type="color" id="color4" value="#5995DA">
          </div>
          <button id="randomButton" class="icon-button">
            <svg t="1734968787827" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="6568" width="200" height="200">
              <path d="M512.128 32a480 480 0 0 0 0 960A479.808 479.808 0 0 0 992 511.936 479.744 479.744 0 0 0 512.128 32zM331.136 688.064L217.728 545.216c-8.768-10.624-0.64-27.008 13.248-27.008h46.272c0.64-49.408 23.104-237.44 302.656-280.64 4.352-0.576 6.144 4.992 2.496 7.488-146.048 84.672-146.048 190.464-147.264 273.728h44.48c13.632 0 21.376 16.256 13.12 26.368L379.392 688a30.592 30.592 0 0 1-48.256 0.064z m462.272-182.336h-46.4c-0.64 50.112-23.104 237.44-302.528 280.704-4.352 0.576-6.272-4.992-2.624-7.488 145.984-84.608 145.984-190.528 147.392-273.856h-44.48c-13.632 0-21.76-16.32-13.12-26.88L644.48 335.36a30.592 30.592 0 0 1 48.128 0l113.536 142.848c8.64 10.56 1.152 26.88-12.736 27.52z" fill="#040000" p-id="6569"></path>
            </svg>
          </button>
        </div>
        <div class="angle-control">
          <div class="angle-header">
            <label for="angle">Gradient Angle</label>
            <span class="angle-value">109.6°</span>
          </div>
          <input type="range" id="angle" min="0" max="360" value="109.6" step="1">
        </div>
      </div>
    </div>
  </div>

  <div class="buttons">
    <button class="create-btn" id="create">Create</button>
    <button class="cancel-btn" id="cancel">Cancel</button>
  </div>

  <script>
    // 监听来自插件的消息
    window.onmessage = (event) => {
      const message = event.data.pluginMessage;
      if (message.type === 'init') {
        document.getElementById('title').value = message.fileName;
      }
    };

    // 等待 DOM 加载完成
    document.addEventListener('DOMContentLoaded', function() {
      // 初始化日期
      const dateInput = document.getElementById('date');
      if (dateInput) {
        dateInput.valueAsDate = new Date();
      }

      // 获取必要的 DOM 元素
      const gradientGrid = document.querySelector('.gradient-grid');
      const color1Input = document.getElementById('color1');
      const color2Input = document.getElementById('color2');
      const color3Input = document.getElementById('color3');
      const color4Input = document.getElementById('color4');
      const angleInput = document.getElementById('angle');
      const angleValue = document.querySelector('.angle-value');
      const randomButton = document.getElementById('randomButton');
      const previewElement = document.querySelector('.gradient-preview');
      const createButton = document.getElementById('create');
      const cancelButton = document.getElementById('cancel');
      const titleInput = document.getElementById('title');
      const subtitleInput = document.getElementById('subtitle');
      const authorInput = document.getElementById('author');

      // 选择渐变
      let selectedGradient = {
        color1: "#4ED4DC",
        color2: "#BB4ACF",
        color3: "#C348DB",
        color4: "#5995DA",
        angle: 109.6
      };

      // 80种精选渐变色组合库
      const gradientLibrary = [
        { color1: '#FF6B6B', color2: '#556270', color3: '#4ECDC4', color4: '#4ECDC4', angle: 45 },
        { color1: '#F7971E', color2: '#FFD200', color3: '#FF9966', color4: '#FF9966', angle: 60 },
        { color1: '#00C6FF', color2: '#0072FF', color3: '#0051FF', color4: '#0051FF', angle: 90 },
        { color1: '#FC466B', color2: '#3F5EFB', color3: '#3F5EFB', color4: '#3F5EFB', angle: 120 },
        { color1: '#A8E6CF', color2: '#DCEDC1', color3: '#FFD3B6', color4: '#FFD3B6', angle: 30 },
        { color1: '#FFD93D', color2: '#FF8E3C', color3: '#FF4949', color4: '#FF4949', angle: 75 },
        { color1: '#6DD5FA', color2: '#2980B9', color3: '#2980B9', color4: '#2980B9', angle: 90 },
        { color1: '#FF5F6D', color2: '#FFC371', color3: '#FFC371', color4: '#FFC371', angle: 45 },
        { color1: '#36D1DC', color2: '#5B86E5', color3: '#5B86E5', color4: '#5B86E5', angle: 60 },
        { color1: '#CB356B', color2: '#BD3F32', color3: '#BD3F32', color4: '#BD3F32', angle: 90 },
        { color1: '#1FA2FF', color2: '#12D8FA', color3: '#A6FFCB', color4: '#A6FFCB', angle: 120 },
        { color1: '#FF0099', color2: '#493240', color3: '#493240', color4: '#493240', angle: 30 },
        { color1: '#004FF9', color2: '#FFF94C', color3: '#FFF94C', color4: '#FFF94C', angle: 75 },
        { color1: '#F4C4F3', color2: '#FC67FA', color3: '#FC67FA', color4: '#FC67FA', angle: 90 },
        { color1: '#00F260', color2: '#0575E6', color3: '#0575E6', color4: '#0575E6', angle: 45 },
        { color1: '#F857A6', color2: '#FF5858', color3: '#FF5858', color4: '#FF5858', angle: 60 },
        { color1: '#4776E6', color2: '#8E54E9', color3: '#8E54E9', color4: '#8E54E9', angle: 90 },
        { color1: '#FFE259', color2: '#FFA751', color3: '#FFA751', color4: '#FFA751', angle: 120 },
        { color1: '#FF3CAC', color2: '#784BA0', color3: '#2B86C5', color4: '#2B86C5', angle: 30 },
        { color1: '#FF9A9E', color2: '#FAD0C4', color3: '#FAD0C4', color4: '#FAD0C4', angle: 75 },
        { color1: '#A8CABA', color2: '#5D4157', color3: '#5D4157', color4: '#5D4157', angle: 90 },
        { color1: '#FF758C', color2: '#FF7EB3', color3: '#FF7EB3', color4: '#FF7EB3', angle: 45 },
        { color1: '#08AEEA', color2: '#2AF598', color3: '#2AF598', color4: '#2AF598', angle: 60 },
        { color1: '#FEE140', color2: '#FA709A', color3: '#FA709A', color4: '#FA709A', angle: 90 },
        { color1: '#5433FF', color2: '#20BDFF', color3: '#A5FECB', color4: '#A5FECB', angle: 120 },
        { color1: '#799F0C', color2: '#ACBB78', color3: '#ACBB78', color4: '#ACBB78', angle: 30 },
        { color1: '#00B4DB', color2: '#0083B0', color3: '#0083B0', color4: '#0083B0', angle: 75 },
        { color1: '#FBF4FB', color2: '#F7CE68', color3: '#F7CE68', color4: '#F7CE68', angle: 90 },
        { color1: '#85FFBD', color2: '#FFFB7D', color3: '#FFFB7D', color4: '#FFFB7D', angle: 45 },
        { color1: '#FF3F3F', color2: '#FF9B9B', color3: '#FF9B9B', color4: '#FF9B9B', angle: 60 },
        { color1: '#2193B0', color2: '#6DD5ED', color3: '#6DD5ED', color4: '#6DD5ED', angle: 90 },
        { color1: '#B2FEFA', color2: '#0ED2F7', color3: '#0ED2F7', color4: '#0ED2F7', angle: 30 },
        { color1: '#FA8BFF', color2: '#2BD2FF', color3: '#2BFF88', color4: '#2BFF88', angle: 75 },
        { color1: '#FF9A9E', color2: '#FECFEF', color3: '#FECFEF', color4: '#FECFEF', angle: 90 },
        { color1: '#43E97B', color2: '#38F9D7', color3: '#38F9D7', color4: '#38F9D7', angle: 45 },
        { color1: '#FA709A', color2: '#FEE140', color3: '#FEE140', color4: '#FEE140', angle: 60 },
        { color1: '#4FACFE', color2: '#00F2FE', color3: '#00F2FE', color4: '#00F2FE', angle: 90 },
        { color1: '#F83600', color2: '#F9D423', color3: '#F9D423', color4: '#F9D423', angle: 120 },
        { color1: '#00DBDE', color2: '#FC00FF', color3: '#FC00FF', color4: '#FC00FF', angle: 30 },

        // 新增的现代感渐变色
        { color1: '#8EC5FC', color2: '#E0C3FC', color3: '#C2E9FB', color4: '#C2E9FB', angle: 145 },
        { color1: '#FFDEE9', color2: '#B5FFFC', color3: '#C2E9FB', color4: '#C2E9FB', angle: 110 },
        { color1: '#FF9A8B', color2: '#FF6A88', color3: '#FF99AC', color4: '#FF99AC', angle: 55 },
        { color1: '#FBF4FB', color2: '#EEF1F5', color3: '#E6E9F0', color4: '#E6E9F0', angle: 135 },
        { color1: '#A9C9FF', color2: '#FFBBEC', color3: '#F3E7E9', color4: '#F3E7E9', angle: 85 },
        { color1: '#21D4FD', color2: '#B721FF', color3: '#21D4FD', color4: '#21D4FD', angle: 165 },
        { color1: '#3EECAC', color2: '#EE74E1', color3: '#FF77E9', color4: '#FF77E9', angle: 45 },
        { color1: '#FA8BFF', color2: '#2BD2FF', color3: '#2BFF88', color4: '#2BFF88', angle: 90 },
        { color1: '#FBDA61', color2: '#FF5ACD', color3: '#FF5ACD', color4: '#FF5ACD', angle: 120 },
        { color1: '#4158D0', color2: '#C850C0', color3: '#FFCC70', color4: '#FFCC70', angle: 30 },
        { color1: '#0093E9', color2: '#80D0C7', color3: '#80D0C7', color4: '#80D0C7', angle: 160 },
        { color1: '#8BC6EC', color2: '#9599E2', color3: '#9599E2', color4: '#9599E2', angle: 135 },
        { color1: '#A9C9FF', color2: '#FFBBEC', color3: '#FFBBEC', color4: '#FFBBEC', angle: 45 },
        { color1: '#FAD961', color2: '#F76B1C', color3: '#F76B1C', color4: '#F76B1C', angle: 140 },
        { color1: '#F4D03F', color2: '#16A085', color3: '#16A085', color4: '#16A085', angle: 105 },
        { color1: '#00DBDE', color2: '#FC00FF', color3: '#FC00FF', color4: '#FC00FF', angle: 90 },
        { color1: '#FEE140', color2: '#FA709A', color3: '#FA709A', color4: '#FA709A', angle: 75 },
        { color1: '#0BA360', color2: '#3CBA92', color3: '#3CBA92', color4: '#3CBA92', angle: 145 },
        { color1: '#FBAB7E', color2: '#F7CE68', color3: '#F7CE68', color4: '#F7CE68', angle: 130 },
        { color1: '#85FFBD', color2: '#FFFB7D', color3: '#FFFB7D', color4: '#FFFB7D', angle: 45 },

        // 高端商务风格渐变
        { color1: '#141E30', color2: '#243B55', color3: '#243B55', color4: '#243B55', angle: 145 },
        { color1: '#2C3E50', color2: '#3498DB', color3: '#3498DB', color4: '#3498DB', angle: 165 },
        { color1: '#000046', color2: '#1CB5E0', color3: '#1CB5E0', color4: '#1CB5E0', angle: 120 },
        { color1: '#0F2027', color2: '#203A43', color3: '#2C5364', color4: '#2C5364', angle: 90 },
        { color1: '#373B44', color2: '#4286F4', color3: '#4286F4', color4: '#4286F4', angle: 145 },
        { color1: '#283048', color2: '#859398', color3: '#859398', color4: '#859398', angle: 115 },
        { color1: '#24C6DC', color2: '#514A9D', color3: '#514A9D', color4: '#514A9D', angle: 155 },
        { color1: '#42275A', color2: '#734B6D', color3: '#734B6D', color4: '#734B6D', angle: 135 },
        { color1: '#BBD2C5', color2: '#536976', color3: '#292E49', color4: '#292E49', angle: 145 },
        { color1: '#304352', color2: '#D7D2CC', color3: '#D7D2CC', color4: '#D7D2CC', angle: 125 },

        // 柔和自然风格
        { color1: '#DCE35B', color2: '#45B649', color3: '#45B649', color4: '#45B649', angle: 135 },
        { color1: '#C6FFDD', color2: '#FBD786', color3: '#F7797D', color4: '#F7797D', angle: 120 },
        { color1: '#2BC0E4', color2: '#EAECC6', color3: '#EAECC6', color4: '#EAECC6', angle: 145 },
        { color1: '#134E5E', color2: '#71B280', color3: '#71B280', color4: '#71B280', angle: 155 },
        { color1: '#FDC830', color2: '#F37335', color3: '#F37335', color4: '#F37335', angle: 145 },
        { color1: '#00B09B', color2: '#96C93D', color3: '#96C93D', color4: '#96C93D', angle: 90 },
        { color1: '#FFEFBA', color2: '#FFFFFF', color3: '#FFFFFF', color4: '#FFFFFF', angle: 125 },
        { color1: '#DAE2F8', color2: '#D6A4A4', color3: '#D6A4A4', color4: '#D6A4A4', angle: 135 },
        { color1: '#F3904F', color2: '#3B4371', color3: '#3B4371', color4: '#3B4371', angle: 145 },
        { color1: '#67B26F', color2: '#4CA2CD', color3: '#4CA2CD', color4: '#4CA2CD', angle: 115 }
      ];

      // 默认的渐变预设（使用前9个）
      const defaultGradients = gradientLibrary.slice(0, 9);

      // 从渐变库中随机选择9个不重复的渐变
      function getRandomGradients() {
        const shuffled = [...gradientLibrary].sort(() => 0.5 - Math.random());
        return shuffled.slice(0, 9);
      }

      // 更新渐变预设
      function updateGradientPresets() {
        if (!gradientGrid) return;
        
        const randomGradients = getRandomGradients();
        gradientGrid.innerHTML = '';
        
        randomGradients.forEach(gradient => {
          const gradientOption = document.createElement('div');
          gradientOption.className = 'gradient-option';
          gradientOption.style.background = `linear-gradient(${gradient.angle}deg, 
            ${gradient.color1}, 
            ${gradient.color2},
            ${gradient.color3},
            ${gradient.color4})`;
          
          gradientOption.addEventListener('click', () => {
            document.querySelectorAll('.gradient-option').forEach(opt => opt.classList.remove('selected'));
            gradientOption.classList.add('selected');
            selectedGradient = gradient;
            
            // 更新颜色输入
            if (color1Input) color1Input.value = gradient.color1;
            if (color2Input) color2Input.value = gradient.color2;
            if (color3Input) color3Input.value = gradient.color3;
            if (color4Input) color4Input.value = gradient.color4;
            
            // 更新角度滑块和显示值
            if (angleInput) angleInput.value = gradient.angle;
            if (angleValue) angleValue.textContent = `${gradient.angle}°`;
            
            updatePreview();
          });
          
          gradientGrid.appendChild(gradientOption);
        });
      }

      // 更新预览
      function updatePreview() {
        if (!previewElement || !selectedGradient) return;
        
        previewElement.style.background = `linear-gradient(${selectedGradient.angle}deg, 
          ${selectedGradient.color1}, 
          ${selectedGradient.color2},
          ${selectedGradient.color3},
          ${selectedGradient.color4})`;
      }

      // 添加事件监听器
      if (randomButton) {
        randomButton.addEventListener('click', updateGradientPresets);
      }

      if (angleInput && angleValue) {
        angleInput.addEventListener('input', (e) => {
          selectedGradient.angle = parseInt(e.target.value);
          angleValue.textContent = `${selectedGradient.angle}°`;
          
          // 更新选中的渐变预设显示
          const selectedOption = document.querySelector('.gradient-option.selected');
          if (selectedOption) {
            selectedOption.style.background = `linear-gradient(${selectedGradient.angle}deg, 
              ${selectedGradient.color1}, 
              ${selectedGradient.color2},
              ${selectedGradient.color3},
              ${selectedGradient.color4})`;
          }
          
          updatePreview();
        });
      }

      // 颜色输入事件监听
      const colorInputs = [
        { input: color1Input, prop: 'color1' },
        { input: color2Input, prop: 'color2' },
        { input: color3Input, prop: 'color3' },
        { input: color4Input, prop: 'color4' }
      ];

      colorInputs.forEach(({input, prop}) => {
        if (input) {
          input.addEventListener('input', (e) => {
            selectedGradient[prop] = e.target.value;
            updatePreview();
          });
        }
      });

      // 创建封面按钮点击事件
      if (createButton) {
        createButton.onclick = () => {
          const title = titleInput ? titleInput.value : '';
          const subtitle = (subtitleInput && subtitleInput.value) || "Please enter your summary";
          const author = (authorInput && authorInput.value) || "Design Team";
          
          if (!title || title.trim() === '') {
            // 显示错误消息
            if (titleInput) {
              titleInput.style.borderColor = '#FF0000';
            }
            return;
          }

          parent.postMessage({
            pluginMessage: {
              type: 'create-gradient-cover',
              title,
              subtitle,
              author,
              color1: selectedGradient.color1,
              color2: selectedGradient.color2,
              color3: selectedGradient.color3,
              color4: selectedGradient.color4,
              angle: selectedGradient.angle
            }
          }, '*');
        };
      }

      // 取消按钮点击事件
      if (cancelButton) {
        cancelButton.onclick = () => {
          parent.postMessage({
            pluginMessage: {
              type: 'cancel'
            }
          }, '*');
        };
      }

      // 初始化
      updateGradientPresets();
      updatePreview();
    });
  </script>
</body>
</html>
